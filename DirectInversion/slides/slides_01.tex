%% This file is automatically generated. Do not edit!
\documentclass[12pt]{cwpslides}

\usepackage{geometry}
\usepackage{mathtools}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{multicol}
\usepackage{color}
\usepackage{overpic}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{comment}
\usepackage{xcolor}

\include{Share/pcsmacros}
\begin{document}
\title[]{From wavefield to model}
\subtitle{}
\author[]{}
\date{}
\logo{}



\Large

\def\big#1{\begin{center} \LARGE \textbf{#1} \end{center}}
\def\cen#1{\begin{center}        \textbf{#1} \end{center}}

% ------------------------------------------------------------
\mode<beamer> { \cwpcover }


\inputdir{.} 
\begin{frame}
  The forward problem:
\[
  {\bf m_0} \rightarrow {\bf u} 
\]

$\bf u$: acoustic wavefield retrieved by Marchenko\\
$\bf m_0$: input model
\end{frame}

\begin{frame}
  The inverse problem:
\[
  {\bf m} \leftarrow {\bf u} ?
\]
$\bf u$: acoustic wavefield\\
$\bf m$: model parameter(s)
\end{frame}

\begin{frame} \frametitle{constant density acoustics}
Forward mapping $\mathcal{F}({\bf m}) = {\bf u}$
\[
   \lp {\bf m}\omega^2  + \nabla^2 \rp {\bf u} = {\bf f}
\]
$\bf f$: known source term \\ 
${\bf m }=\frac{1}{v^2}$: slowness squared
\end{frame}

\begin{frame} \frametitle{constant density acoustics}
Forward mapping $\mathcal{F}({\bf m}) = {\bf u}$
\[
   {\bf B}(\omega,{\bf m}){\bf u} = {\bf f}
\]
$\bf f$: known source term \\ 
${\bf m }=\frac{1}{v^2}$: slowness squared
\end{frame}

\begin{frame} \frametitle{constant density acoustics}
Forward mapping $\mathcal{F}({\bf m}) = {\bf u}$
\[
   {\bf u} = {\bf B}(\omega,{\bf m})^{-1}{\bf f}
\]
$\bf f$: known source term \\ 
${\bf m }=\frac{1}{v^2}$: slowness squared
\end{frame}






\begin{frame} \frametitle{constant density acoustics}
Inverse mapping $\mathcal{F}^{-1}({\bf u}) = {\bf m}$?
\end{frame}

\begin{frame} \frametitle{constant density acoustics}
Inverse mapping $\mathcal{F}^{-1}({\bf u}) = {\bf m}$?
\[
  {\bf m } \omega^2 {\bf u}  = {\bf f} -\nabla^2{\bf u}  
\]
\end{frame}

\begin{frame} \frametitle{constant density acoustics}
In matrix form:
\[
  {\bf A}(\omega,{\bf u})  {\bf m } = {\bf f} -{\bf L}{\bf u}  
\]
with 
\[
  A(\omega,{\bf u}) = 
  \begin{pmatrix}
    \omega^2 u_1  & 0             & 0      &  0 \\
        0         & \omega^2 u_2  & 0      &  0 \\
        \vdots    & 0             & \ddots &  0 \\
        0         & 0             & 0      & \omega^2 u_N
  \end{pmatrix}
\]
\end{frame}


\begin{frame} \frametitle{constant density acoustics}
  
Let 
\[
{\bf A}_i = A(\omega, {\bf u}^i)
\]

and,
  \[
    {\bf r_i} = {\bf f}_i -{\bf L}{\bf u}_i
  \]
Then, the least squares estimate solves:
\[
  \begin{pmatrix}
     {\bf A}_1  \\
     {\bf A}_2  \\ 
      \vdots    \\
     {\bf A}_N 
  \end{pmatrix}
  {\bf m} = 
  \begin{pmatrix}
     {\bf r}_1  \\
     {\bf r}_2  \\ 
      \vdots    \\
     {\bf r}_N 
  \end{pmatrix}
\]
\end{frame}



\begin{frame}
  \big{examples}
\end{frame}

\begin{frame} \frametitle{passing the inverse crime}
   \[
        {\bf m} \rightarrow {\bf u}
   \]
   \[
        {\bf m} \leftarrow {\bf u} ? 
   \]
 For $\bf m$ we have 1 equation and 1 unknown for each pixel. So, 
in theory 1 frequency and 1 source should suffice
\end{frame}

\inputdir{layeredModel}

\begin{frame} \frametitle{the inverse crime}
  \plot{m}{width=\textwidth}{}
\end{frame}

\begin{frame} \frametitle{the inverse crime}
  \plot{u}{width=\textwidth}{}
\end{frame}

\begin{frame} \frametitle{the inverse crime}
  \plot{minv}{width=\textwidth}{}
\end{frame}

\begin{frame} \frametitle{the inverse crime}
  \plot{m}{width=\textwidth}{}
\end{frame}

\begin{frame}
  \big{relaxing the crime}
\end{frame}

\begin{frame}
   \[
        {\bf m} \rightarrow {\bf u}
   \]
Using time-domain (high-order spatial stencil, 2 order in time).
\[
   u(x,\omega) = \sum_t u(x,t) \exp(-i\omega t) 
\]
\end{frame}
\begin{frame} \frametitle{inconsistencies}
  td: 
  $\partial_t^2 u(x,t) = (u(x,t-\Delta t) -2u(x,t) +u(x,t+\Delta t))/\Delta t^2$

  $\nabla^2 =$ long filter

\end{frame}
\begin{frame} \frametitle{inconsistencies}
  fd:
  $\partial_t^2 u(x,t) \rightarrow -\omega^2 u(x,\omega) $
  
  \[
  \nabla^2 =1/dx^2* 
    \begin{pmatrix}
      0 & +1 & 0\\
      1 & -4 & 1 \\
      0 & +1 & 0
    \end{pmatrix}
  \]
\end{frame}

\inputdir{td_green}
\begin{frame} \frametitle{f=12Hz}
  \plot{minv_1f}{width=\textwidth}{}
\end{frame}
\begin{frame} \frametitle{f=12,14,...,30Hz}
  \plot{minv_10f}{width=\textwidth}{}
\end{frame}


\begin{frame}
  \big{Marchenko wavefields}
\end{frame}

\begin{frame}
  \begin{itemize}
    \item Reconstructed Green's functions in a box inside the medium.
    \item Six source locations (equispaced at the surface).
    \item Ten frequencies: $ f=21,25,29,...,61Hz$.
    \item Not an inverse crime: the forward modeling is quite different from the inverse one. 
  \end{itemize}
\end{frame}

\inputdir{blind}
\begin{frame} \frametitle{inverted model}
  \plot{minv_1}{width=0.7\textwidth}{}
\end{frame}
\begin{frame} \frametitle{inverted model}
  \plot{minv}{width=0.7\textwidth}{}
\end{frame}
\begin{frame} \frametitle{stabilizing the inversion}
Now we solve:
\[
    \begin{pmatrix}
         {\bf A} 
    \end{pmatrix} {\bf m} = 
    \begin{pmatrix}
      {\bf r}
    \end{pmatrix}
\]
\end{frame}
\begin{frame} \frametitle{stabilizing the inversion}

We can solve:
\[
    \begin{pmatrix}
         {\bf A} \\ 
        \epsilon {\bf R} 
    \end{pmatrix} {\bf m} = 
    \begin{pmatrix}
      {\bf r}\\
      {\bf 0} 
    \end{pmatrix}
\]
Where $\bf R$ highlights an undesirable feature of the model
\end{frame}

\begin{frame}
possible $\bf R$s:
   \[
    {\bf R} = {\bf Dx}
   \]
   \[
    {\bf R} =
    \begin{pmatrix}
        {\bf Dx} \\
        {\bf Dz}  
    \end{pmatrix} 
   \]
   \[
    {\bf R} = {\bf Dz}
   \]
\end{frame}

\begin{frame} \frametitle{reg inverted model 1 source}
  \plot{minv_reg_1}{width=0.7\textwidth}{}
\end{frame}

\begin{frame} \frametitle{reg inverted model 6 sources}
  \plot{minv_reg_6}{width=0.7\textwidth}{}
\end{frame}


\begin{frame} \frametitle{inverted model}
  \plot{minv}{width=0.7\textwidth}{}
\end{frame}


\end{document}
